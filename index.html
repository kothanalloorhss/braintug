<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tug of War Arena</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gray: { 900: '#0f172a', 800: '#1e293b', 700: '#334155' },
                        accent: '#22c55e',
                        danger: '#ef4444',
                        p1: '#3b82f6',
                        p2: '#f97316',
                    },
                    fontFamily: { mono: ['Courier New', 'monospace'] }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-900 text-white h-screen overflow-hidden flex flex-col select-none font-sans">

    <audio id="bgm" loop><source src="assets/bgm.mp3" type="audio/mpeg"></audio>
    <audio id="sfx-correct"><source src="assets/correct.mp3" type="audio/mpeg"></audio>
    <audio id="sfx-wrong"><source src="assets/wrong.mp3" type="audio/mpeg"></audio>
    <audio id="sfx-win"><source src="assets/win.mp3" type="audio/mpeg"></audio>

    <div id="screen-menu" class="screen flex flex-col items-center justify-center h-full w-full p-4 space-y-8 absolute inset-0 bg-gray-900 z-50">
        <h1 class="text-6xl md:text-8xl font-black uppercase tracking-tighter text-transparent bg-clip-text bg-gradient-to-br from-p1 to-p2 drop-shadow-lg">
            Brain Tug
        </h1>
        
        <div class="flex gap-6 bg-gray-800 p-2 rounded-xl">
            <button onclick="setGameType('math')" id="btn-math" class="px-6 py-2 rounded-lg font-bold bg-blue-600 text-white ring-2 ring-blue-400">
                <i class="fas fa-calculator mr-2"></i>Math Mode
            </button>
            <button onclick="setGameType('english')" id="btn-eng" class="px-6 py-2 rounded-lg font-bold text-gray-400 hover:text-white">
                <i class="fas fa-book mr-2"></i>English Mode
            </button>
        </div>

        <div class="grid grid-cols-2 gap-6 w-full max-w-xl">
            <button onclick="setupQuickPlay()" class="bg-gray-800 hover:bg-gray-700 p-8 rounded-2xl border-2 border-gray-700 transition-all hover:-translate-y-1">
                <h3 class="text-2xl font-bold text-accent mb-2">Quick Play</h3>
                <p class="text-gray-400 text-sm">Instant 1v1 Battle</p>
            </button>
            <button onclick="setupTournament()" class="bg-gray-800 hover:bg-gray-700 p-8 rounded-2xl border-2 border-gray-700 transition-all hover:-translate-y-1">
                <h3 class="text-2xl font-bold text-purple-400 mb-2">Tournament</h3>
                <p class="text-gray-400 text-sm">Bracket System</p>
            </button>
        </div>
        
        <div class="text-gray-500 text-sm mt-8 bg-gray-800 px-4 py-2 rounded border border-gray-700">
            <p><strong>P1 (Left):</strong> Use Top Row Numbers + 'A' to Submit</p>
            <p><strong>P2 (Right):</strong> Use Numpad Numbers + 'Enter' to Submit</p>
        </div>
    </div>

    <div id="screen-quick-setup" class="screen hidden flex-col items-center justify-center h-full w-full absolute inset-0 bg-gray-900 z-50">
        <div class="bg-gray-800 p-8 rounded-2xl shadow-2xl w-full max-w-md border border-gray-700">
            <h2 class="text-2xl font-bold mb-6 text-center">Challengers</h2>
            <input id="qp-p1" type="text" placeholder="Player 1 Name" class="w-full bg-gray-900 border border-gray-600 p-3 rounded mb-4 text-p1 font-bold focus:border-p1 outline-none">
            <input id="qp-p2" type="text" placeholder="Player 2 Name" class="w-full bg-gray-900 border border-gray-600 p-3 rounded mb-6 text-p2 font-bold focus:border-p2 outline-none">
            <div class="flex gap-4">
                <button onclick="showScreen('screen-menu')" class="flex-1 py-3 bg-gray-700 rounded font-bold">Back</button>
                <button onclick="startQuickGame()" class="flex-1 py-3 bg-accent rounded font-bold text-black">Start</button>
            </div>
        </div>
    </div>

    <div id="screen-tourney-setup" class="screen hidden flex-col items-center h-full w-full p-8 absolute inset-0 bg-gray-900 z-50">
        <h2 class="text-3xl font-bold mb-6 text-purple-400">Tournament Registry</h2>
        <div class="flex w-full max-w-xl gap-2 mb-6">
            <input id="tourney-input" type="text" placeholder="Enter Name..." class="flex-1 bg-gray-800 border border-gray-600 p-4 rounded-lg outline-none focus:border-purple-500 text-lg">
            <button onclick="addTourneyPlayer()" class="px-8 bg-purple-600 hover:bg-purple-500 rounded-lg font-bold"><i class="fas fa-plus"></i></button>
        </div>
        <ul id="tourney-list" class="w-full max-w-xl flex-1 bg-gray-800 rounded-xl p-4 overflow-y-auto mb-6 border border-gray-700 space-y-2"></ul>
        <div class="flex gap-4 w-full max-w-xl">
            <button onclick="showScreen('screen-menu')" class="px-6 py-4 bg-gray-700 rounded-lg font-bold">Back</button>
            <button onclick="generateFixture()" id="btn-start-tourney" class="flex-1 bg-green-500 hover:bg-green-400 text-black font-bold rounded-lg hidden">GENERATE FIXTURE</button>
        </div>
    </div>

    <div id="screen-tourney-hub" class="screen hidden flex-col h-full w-full p-4 absolute inset-0 bg-gray-900 z-50">
        <header class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold text-purple-400">Tournament Bracket</h2>
            <button onclick="quitTournament()" class="text-red-400 text-sm">Exit</button>
        </header>
        <div class="flex-1 flex gap-6 overflow-hidden">
            <div class="flex-1 bg-gray-800 rounded-xl p-6 overflow-y-auto border border-gray-700" id="bracket-view"></div>
            <div class="w-80 flex flex-col gap-6">
                <div class="bg-gray-800 p-6 rounded-xl border border-gray-700 h-1/2 flex flex-col justify-center text-center">
                    <h3 class="text-gray-400 uppercase text-xs font-bold mb-4">Up Next</h3>
                    <div id="next-match-card"></div>
                </div>
                <div class="bg-gray-800 p-6 rounded-xl border border-gray-700 flex-1 overflow-y-auto">
                    <h3 class="text-gray-400 uppercase text-xs font-bold mb-4">Log</h3>
                    <ul id="winners-log" class="text-sm space-y-2 text-green-400 font-mono"></ul>
                </div>
            </div>
        </div>
    </div>

    <div id="screen-game" class="screen hidden h-full w-full flex-col relative bg-gray-900 absolute inset-0 z-40">
        <div class="flex justify-between items-center p-4 bg-gray-800 border-b border-gray-700 z-10 shadow-lg">
            <div class="w-1/3 flex items-center gap-3">
                <div class="w-3 h-12 bg-p1 rounded-full"></div>
                <div>
                    <h3 id="game-p1-name" class="text-xl font-bold text-white leading-none">Player 1</h3>
                    <span class="text-p1 text-sm font-bold">SCORE: <span id="score-p1">0</span></span>
                </div>
            </div>
            <div class="bg-black px-6 py-2 rounded-lg border border-gray-600">
                <span id="game-timer" class="text-3xl font-mono font-bold text-white">60</span>
            </div>
            <div class="w-1/3 flex items-center gap-3 justify-end">
                <div class="text-right">
                    <h3 id="game-p2-name" class="text-xl font-bold text-white leading-none">Player 2</h3>
                    <span class="text-p2 text-sm font-bold">SCORE: <span id="score-p2">0</span></span>
                </div>
                <div class="w-3 h-12 bg-p2 rounded-full"></div>
            </div>
        </div>

        <div class="flex-1 flex relative">
            <div class="flex-1 border-r border-gray-800 flex flex-col items-center justify-center p-8 relative">
                <div class="mb-8 text-center">
                    <div id="q-p1-text" class="text-5xl font-black text-white mb-4">...</div>
                    <div id="q-p1-opts" class="grid grid-cols-3 gap-2 text-lg text-gray-400 font-mono hidden"></div>
                </div>
                <div id="input-p1" class="text-6xl font-mono text-p1 border-b-4 border-gray-700 min-h-[80px] min-w-[150px] text-center transition-colors duration-100"></div>
                <div id="feedback-p1" class="h-6 mt-4 font-bold text-xl"></div>
            </div>

            <div class="absolute inset-y-0 left-0 right-0 pointer-events-none flex items-center justify-center overflow-hidden">
                <div class="w-full h-1 bg-gray-700 relative">
                    <div class="absolute left-1/2 -ml-0.5 top-0 bottom-0 w-1 bg-gray-500 h-4 -mt-1.5"></div>
                </div>
                <div id="rope-marker" class="absolute w-16 h-16 bg-yellow-500 rounded-full border-4 border-gray-900 z-20 flex items-center justify-center shadow-2xl transition-transform duration-300 ease-out">
                    <i class="fas fa-grip-lines-vertical text-black opacity-50 text-2xl"></i>
                </div>
            </div>

            <div class="flex-1 border-l border-gray-800 flex flex-col items-center justify-center p-8 relative">
                <div class="mb-8 text-center">
                    <div id="q-p2-text" class="text-5xl font-black text-white mb-4">...</div>
                    <div id="q-p2-opts" class="grid grid-cols-3 gap-2 text-lg text-gray-400 font-mono hidden"></div>
                </div>
                <div id="input-p2" class="text-6xl font-mono text-p2 border-b-4 border-gray-700 min-h-[80px] min-w-[150px] text-center transition-colors duration-100"></div>
                <div id="feedback-p2" class="h-6 mt-4 font-bold text-xl"></div>
            </div>
        </div>
    </div>

    <div id="modal" class="fixed inset-0 bg-black/90 z-[60] hidden flex items-center justify-center">
        <div class="bg-gray-800 p-8 rounded-2xl max-w-sm w-full text-center border border-gray-600 shadow-2xl">
            <h2 id="modal-title" class="text-3xl font-bold mb-2 text-white">Winner!</h2>
            <p id="modal-msg" class="text-gray-400 mb-6">Results</p>
            <button id="modal-btn" class="w-full py-3 bg-accent text-black font-bold rounded hover:bg-green-400">Continue</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>